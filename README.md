# Play-of-the-Playoffs
An NBA project built around statistical changes from the regular – post-season powered by basketball reference (https://www.basketball-reference.com/)

# Final Paper

Stephan MacDougall and Kayson Shaikh

Professor Gold

Introduction to Data Science with Python

8 December 2023

The Play of the Playoffs

(For access to images visit this google doc: https://docs.google.com/document/d/1zjkGBmsTuCfcBT1cYs4A0Y9YmKbIAdGW6TNVAkxbDjQ/edit?usp=sharing)

In the world of basketball, more specifically the NBA, clutch is a term that is thrown around very liberally; the term relates to the phenomenon where athletes excel under pressure. Analysts attempt to identify different factors that indicate whether or not a team is constructed with clutch players or playoff culture, among many other things, that culminate to winning the ultimate prize, The Larry O’Brien Trophy. Supposedly, the NBA playoffs is a whole different animal compared to the regular season. We wanted to see if the analytics supported this theory. We set out to see the difference between regular season and playoff play, both for individuals and teams. To do so we looked at both team stats like Pace, True Shooting %, 3-Point %, Free-Throw %, 3-Point Attempt rate, Free-Throw Attempt rate, Assist %, Turnover %, Offensive Rebound %, Defensive Rebound %, Offensive Rating, and Defensive Rating. Additionally, we wanted to predict player success in the playoffs using stats as follows (with their definitions): tm – team played for; g – games played; mp – minutes played; fg% – percentage of field goals scored; – 3p% percentage of three pointers scored; fta – free throws attempted; ft% free throw percentage; trb – total rebounds; ast – total assists; stl – total steals; blk – total blocks; tov – total turnovers to the other team; pts – total points; per – player efficiency rating which measures how efficient players are in their time on the court; ts% – true shooting percentage which weighs different shot types; tov% – percentage of turnovers when the player touches the ball; usg% – how many touches the player gets when on the court; ws – how many wins the player provides for their team; ws/48 – regularizes win shares for every 48 minutes; bpm – box plus / minus which measures the point difference between the team played for to the team played against; vorp – the value a player has compared to a replacement level player; dist. – average shot distance for a player; %fga dunks – what percent of a players field goals attempted were slam dunk attempts.

Before we could use statistics or machine learning, we had to prepare our data. Our data came through web scraping, using pd.read, on an NBA database called basketball reference. We first read specific tables from different pages on the website into panda dataframes. For these tables we had to drop certain columns that were unnamed as they were only there for the function of visuals on the site itself and would be of no use to us.

Specific to the tables that held player statistics, we used a function that we called “scrub” to remove any duplicate players that were made in the table to represent players that played for multiple teams in the same year. Moving on, we used “df.loc” to maintain specific columns that we actually were going to use in our analysis these columns included: Player, Pos, Age, Tm, G, MP, FG%, 3P%, FTA, FT%, TRB, AST, STL, BLK, TOV, PTS, PER, TS%, TOV%, USG%, WS, WS/48, BPM, VORP, Dist., and %FGA dunks. Due to the fact that the player data was still split across multiple data frames (due to the way pd.read works) we had to keep the ‘Player’ column across all three of these dataframes. Next, we collected the data for players across multiple years in different dataframes. Next, we merged the data frames that contained player stats on the column ‘Player’ to have the important individual statistics in the same dataframe. We did this to create dataframes for each year and different dataframes for regular season and playoff stats so we could compare the different times of play. Finally, before we could use machine learning we created specific data frames that only had data from columns that we wanted to use for our linear regression model like regular season points, assists, rebounds, true shooting percentage, player efficiency, and another data frame with playoff points that represented the dependent variable.

Specific to the tables that held team data, we had to rename the columns of the shooting and advanced statistics data frames in order for them to function more smoothly with the ensuing code as originally there were two rows that named the columns. While renaming the columns, we named the columns of the statistics that we deemed unnecessary ‘drop1’, ‘drop2’, … and made a function “drop_columns” to drop these columns. Specific to the playoff dataframes of 2023, we had to drop the rows that included teams that did not play a playoff game as they were a part of the table because they played in the play-in tournament. We then wrote a for loop that combined the data of certain statistics for the last seven years and put them into separate lists, with each statistic having one for the regular season data and one for the playoffs in order to run t-tests comparing the statistics in the regular season vs the playoffs, and to create a new data frame that will be turned into a catplot. Because the pace of play changes in the playoffs, we divided the lists of Assists Per Game for each team by the Pace of place of that team in order to create the stat of Assists per possession(‘ASTper’ or ‘AST%) that would give a more accurate picture of how the rate of assists change in the playoffs compared to the regular season. In order to create a catplot, we first had to scale the lists with the data so the percentages weren’t in decimal form. We did this by turning the lists into arrays and multiplying them by 100. Then we created two new dataframes, one with the regular season data and one with the playoff data, and concatenated these data frames by the rows, and labeled each row with the data frame it came from which allowed us to make a new column in this data frame that says whether the data of that row is from the regular or postseason. Finally we melted the dataframe, but kept the column that labeled where the data was from, in order to prepare it to be visualized in a catplot. 

We ran multiple t-tests on different team statistics, comparing them in the regular and postseason, in order to determine whether or not there is a statistically significant difference with these stats in these situations. We ran t-tests for the stats: Pace, True Shooting %, 3-Point %, Free-Throw %, 3-Point Attempt rate, Free-Throw Attempt rate, Assist %, Turnover %, Offensive Rebound %, Defensive Rebound %, Offensive Rating, and Defensive Rating.

We found that there is not a statistically significant difference in Free-Throw %, 3-Point Attempt rate, Turnover %, and Defensive Rebound %. In the playoffs, Pace of play, True Shooting %, 3-Point %, Assist %, Offensive Rebound %, and Offensive Rating all decrease while Free Throw Attempt rate and Defensive Rating increase.

For our machine learning method we used linear regression to predict points per game for players in the playoffs based on regular season stats. The stats that we used to predict playoff points per game included regular season points per game, assists per game, total rebounds per game, true shooting percentage, and player efficiency rating. Linear regression was a suitable choice for this problem because the model allows for a straightforward interpretation of how regular season stats influence playoff performance. Additionally, we made sure to create a correlation heat map between different statistics. This heatmap helped us identify which stats would be best used as features to predict points as the two stats would be correlated. Initially, we just used points in the regular season to predict points in the playoffs. However, we applied the info from the correlation visualization to create a model that should be accurate. When we tried varying the features that we used for prediction to the 5 stats most correlated with points, according to the correlation heatmap, we got a model that still wasn’t as accurate as we liked. However, we found that the additions of assists per game, total rebounds per game, true shooting percentage, and player efficiency rating made a more accurate model, other stats that were correlated with points, made the most accurate predictions.

We used both R2 and Mean Squared Error as measures of accuracy for our linear regression model. The R2 value for the initial model that just used regular season points per game as a predictor for postseason points per game had an R2 value of 0.695 and a Mean Squared Error of 13.468. When we used points per game, minutes played, free throws attempted, turnovers, and assists we got a model with R2 value 0.695 and Mean Squared Error 13.479. The most improved model with points, assists, rebounds, true shooting percentage, and player efficiency rating as the predicting features had an R2 value of 0.711 and a Mean Squared Error of 12.760.

These are the visualizations that came from our statistical and machine learning methods:

From the above, it was made clear which stats are most correlated with points. This gave us indicators that were helpful in building the linear regression model that linked postseason points to other stats.

From the above, the overall accuracy of our machine learning model was assessed. This was a helpful visualization alongside the R2 and Mean Squared Error in creating the most accurate model.

The catplot visualizes the t-tests and shows the difference in the averages of the statistics and whether or not those differences are statistically significant or not. 
We concluded that there are indeed factors that can help to predict the success of individuals and teams in the playoffs. Different counting stats like points, assists, and rebounds alongside true shooting percentage and player efficiency are great indicators of who will have success as a scorer in the postseason. Teams as a whole play differently when it comes to the postseason. Teams tighten up on defense which is shown by the pace of play decreasing, true shooting percentage decreasing while the free throw percentage doesn't show change, offensive rebound percentage decreasing, defensive rating increasing, and the offensive rating decreasing. We have also concluded that teams tend to pass the ball less and play through their stars as assist percentage goes down in the playoffs. Throughout this experience, we learned the difficulties of compiling data across multiple years from a changing league. The NBA’s playoff format recently saw changes and basketball reference itself changed some parts of its interface throughout the years. This made it difficult to get the data that we needed, however we persevered through these roadblocks by checking the data as we went to make sure it made sense with what we knew from our knowledge of the NBA. 
